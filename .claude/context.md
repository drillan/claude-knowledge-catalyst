# Context.md - プロジェクト背景と制約

## プロジェクト概要

**Claude Knowledge Catalyst (CKC)** は、Claude Code開発で得られた知見を自動的にObsidianなどの知識管理ツールと同期する包括的なナレッジマネジメントシステムです。

### 技術スタック
- **言語**: Python 3.11+
- **パッケージ管理**: uv (uvを使用した現代的なPython依存関係管理)
- **設定管理**: Pydantic（バリデーション付きデータモデル）
- **CLI**: Click + Rich（美しいコマンドラインインターフェース）
- **ファイル監視**: Watchdog（デバウンス機能付きファイルシステム監視）

### 核となる機能
1. **自動同期**: `.claude/`ディレクトリを監視してリアルタイム同期
2. **メタデータ管理**: タグ、カテゴリ、成功指標による自動的なメタデータ強化
3. **テンプレートシステム**: プロンプト、コードスニペット、概念、プロジェクトログ用の豊富なテンプレート
4. **Obsidian統合**: Obsidianボルトとの深い統合（適切なディレクトリ構造とリンク）
5. **マルチプロジェクト対応**: 複数プロジェクトでのファイル分離と横断検索（詳細: `.claude/next_action.md`）
6. **成功追跡**: プロンプトの効果測定と継続的改善

## アーキテクチャ制約

### ディレクトリ構造
```
src/claude_knowledge_catalyst/
├── core/                   # コア機能
│   ├── config.py          # 設定管理
│   ├── metadata.py        # メタデータ抽出・管理  
│   └── watcher.py         # ファイルシステム監視
├── sync/                  # 同期モジュール
│   └── obsidian.py        # Obsidian統合
├── templates/             # テンプレートシステム
│   └── manager.py         # テンプレート管理
└── cli/                   # コマンドラインインターフェース
    └── main.py            # CLI実装
```

### 設計パターン
- **Pydanticモデル**: 設定とデータ検証
- **プラグインアーキテクチャ**: 拡張可能な同期ターゲット
- **テンプレート駆動**: コンテンツ生成
- **イベント駆動**: ファイル同期
- **構造化メタデータ**: インテリジェントな組織化

## 開発制約

### パッケージ管理
- **必須**: `uv`コマンドの使用（`pip`ではない）
- **開発環境セットアップ**: `uv sync --dev`
- **コマンド実行**: `uv run ckc [command]`
- **依存関係追加**: `uv add package-name`

### コード品質
```bash
# リンティング
uv run ruff check src/ tests/

# フォーマット
uv run ruff format src/ tests/

# 型チェック
uv run mypy src/

# テスト
uv run pytest
```

### ファイルパス操作
- **必須**: `pathlib.Path`の使用（`os.path`ではない）
- **設定ファイル**: `ckc_config.yaml`（YAMLフォーマット）

## 重要な技術的決定

### メタデータ管理
- フロントマターとコンテンツから自動抽出
- 多次元タグシステム
- 成功率追跡（プロンプト効果測定）
- バージョン履歴管理

### Obsidian統合
- PARAメソッドに基づく自動ボルト構造作成
- 豊富なメタデータ付きフロントマター
- インテリジェントなファイル分類と配置
- クロスプロジェクト知識リンク

### エラーハンドリング
- 適切なエラーハンドリングパターンの実装
- 外部依存関係の適切なモック化
- エラー条件とエッジケースのテスト

## プロジェクト制約

### 設定管理
- `ckc_config.yaml`がメイン設定ファイル
- Pydanticによる設定検証
- 複数同期ターゲットのサポート

### 開発ワークフロー
1. **新機能追加時**: Pydanticモデルを使用
2. **テスト**: 全ての核となる機能に包括的テスト
3. **CLI更新**: ユーザー向け機能の場合
4. **エラーハンドリング**: 既存パターンに従う
5. **型ヒント**: 全コードに型ヒント使用

### 知識組織システム
```
Obsidian_Vault/
├── 00_Inbox/                    # 未処理アイテム
├── 01_Projects/                 # プロジェクト固有知識
├── 02_Knowledge_Base/           # 共有知識
│   ├── Prompts/
│   ├── Code_Snippets/
│   ├── Concepts/
│   └── Resources/
├── 03_Templates/                # ノートテンプレート
├── 04_Analytics/                # 使用状況と効果指標
└── 05_Archive/                  # 非推奨知識
```

## 今後の課題

### 技術的負債
- テストカバレッジの向上
- より堅牢なエラーハンドリング
- パフォーマンス最適化

### 機能拡張
- Webインターフェース
- Notion統合
- AI駆動インサイト
- チームコラボレーション機能
- 高度な分析機能
- プラグインシステム